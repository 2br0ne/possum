{% extends "base.html" %}
{% block content %}

<ul id="back">
<li onclick="window.location='/manager/'">Retour</li>
</ul>

{% if date %}
<h1>Rapport du {{date|date:'l d F Y'}}</h1>
<form method='post' action='/manager/rapports/daily/' name='journalier'>{% csrf_token %}
<ul id="date_form">
    {{ date_form.as_ul }}
    <li><input type='submit' value='Afficher le jour'></li>
</form>
</ul>
{% elif week %}
<h1>Rapport semaine {{week}}/{{year}}</h1>
<form method='post' action='/manager/rapports/weekly/' name='hebdomadaire'>{% csrf_token %}
<ul id="week_form">
    {{ week_form.as_ul }}
    <li><input type='submit' value='Afficher la semaine'></li>
</form>
</ul>
{% elif month %}
<h1>Rapport mois {{month}}/{{year}}</h1>
<form method='post' action='/manager/rapports/monthly/' name='mensuel'>{% csrf_token %}
<ul id="month_form">
    {{ month_form.as_ul }}
    <li><input type='submit' value='Afficher le mois'></li>
</form>
</ul>
{% endif %}

<h2>Général</h2>
<ul id="rapports">
    <li {% if nb_bills > last_nb_bills %}class="enabled"{% endif %}>
        Nb factures: {{nb_bills}}
        </br>Moy. {{avg_nb_bills}} / Max. {{max_nb_bills}}
    </li>
    <li {% if total_ttc > last_total_ttc %}class="enabled"{% endif %}>
        Total TTC: {{total_ttc}}€
        </br>Moy. {{avg_total_ttc}} / Max. {{max_total_ttc}}
    </li>
    <li 
{% if date %}
onclick="window.location='/manager/rapports/{{date.year}}/{{date.month}}/{{date.day}}/send/'"
{% elif week %}
onclick="window.location='/manager/rapports/weekly/{{year}}/{{week}}/send/'"
{% elif month %}
onclick="window.location='/manager/rapports/monthly/{{year}}/{{month}}/send/'"
{% endif %}
    >Envoyer par mail</li>
    <li 
{% if date %}
onclick="window.location='/manager/rapports/{{date.year}}/{{date.month}}/{{date.day}}/print/'"
{% elif week %}
onclick="window.location='/manager/rapports/weekly/{{year}}/{{week}}/print/'"
{% elif month %}
onclick="window.location='/manager/rapports/monthly/{{year}}/{{month}}/print/'"
{% endif %}
    >Imprimer</li>
</ul>

<h3>L'année dernière</h3>
<ul id="rapports">
    <li>Nb factures: {{last_nb_bills}}</li>
    <li>Total TTC: {{last_total_ttc}}€</li>
</ul>

<h2>Restauration</h2>
<ul id="rapports">
    <li {% if guests_nb > last_guests_nb %}class="enabled"{% endif %}>
        Nb de couverts: {{guests_nb}}
        </br>Moy. {{avg_guests_nb}} / Max. {{max_guests_nb}}
    </li>
    <li {% if guests_total_ttc > last_guests_total_ttc %}class="enabled"{% endif %}>
        Total TTC: {{guests_total_ttc}}€
        </br>Moy. {{avg_guests_total_ttc}} / Max. {{max_guests_total_ttc}}
    </li>
    <li {% if guests_average > last_guests_average %}class="enabled"{% endif %}>
        TM/couvert: {{guests_average}}€
        </br>Moy. {{avg_guests_average}} / Max. {{max_guests_average}}
    </li>
</ul>

<h3>L'année dernière</h3>
<ul id="rapports">
    <li>Nb de couverts: {{last_guests_nb}}</li>
    <li>Total TTC: {{last_guests_total_ttc}}€</li>
    <li>Tic. moyen / couvert: {{last_guests_average}}€</li>
</ul>

<h2>Bar</h2>
<ul id="rapports">
    <li {% if bar_nb > last_bar_nb %}class="enabled"{% endif %}>
        Nb factures: {{bar_nb}}
        </br>Moy. {{avg_bar_nb}} / Max. {{max_bar_nb}}
    </li>
    <li {% if bar_total_ttc > last_bar_total_ttc %}class="enabled"{% endif %}>
        Total TTC: {{bar_total_ttc}}€
        </br>Moy. {{avg_bar_total_ttc}} / Max. {{max_bar_total_ttc}}
    </li>
    <li {% if bar_average > last_bar_average %}class="enabled"{% endif %}>
        TM/facture: {{bar_average}}€
        </br>Moy. {{avg_bar_average}} / Max. {{max_bar_average}}
    </li>
</ul>

<h3>L'année dernière</h3>
<ul id="rapports">
    <li>Nb factures bar: {{last_bar_nb}}</li>
    <li>Total TTC: {{last_bar_total_ttc}}€</li>
    <li>Tic. moyen / facture: {{last_bar_average}}€</li>
</ul>

<h2>TVA</h2>
<ul id="rapports">
    {% for vat in vats %}
    <li>{{vat}}€</li>
    {% empty %}
    <li>Aucune TVA</li>
    {% endfor %}
    <li 
{% if date %}
onclick="window.location='/manager/rapports/{{date.year}}/{{date.month}}/{{date.day}}/vats/send/'"
{% elif week %}
onclick="window.location='/manager/rapports/weekly/{{year}}/{{week}}/vats/send/'"
{% elif month %}
onclick="window.location='/manager/rapports/monthly/{{year}}/{{month}}/vats/send/'"
{% endif %}
    >Envoyer par mail</li>
    <li 
{% if date %}
onclick="window.location='/manager/rapports/{{date.year}}/{{date.month}}/{{date.day}}/vats/print/'"
{% elif week %}
onclick="window.location='/manager/rapports/weekly/{{year}}/{{week}}/vats/print/'"
{% elif month %}
onclick="window.location='/manager/rapports/monthly/{{year}}/{{month}}/vats/print/'"
{% endif %}
    >Imprimer</li>
</ul>

<h2>Paiements</h2>
<ul id="rapports">
    {% for payment in payments %}
    <li>{{payment}}€</li>
    {% endfor %}
</ul>

<h2>Categories</h2>
<ul id="rapports">
    {% for category in categories %}
    <li style="background:{{category.color}};">{{category.nom}} : {{category.nb}}</li>
    {% empty %}
    <li>Rien à afficher</li>
    {% endfor %}
</ul>

<h2>Produits</h2>
<ul id="rapports">
    {% for product in products %}
    <li style="background:{{product.categorie.color}};">{{product.nom}} : {{product.nb}}</li>
    {% empty %}
    <li>Rien à afficher</li>
    {% endfor %}
</ul>

{% endblock %}

