{% extends "base.html" %}
{% block content %}

<ul id="back">
    <li onclick="window.location='{% url "bill_view" bill.id %}'">Retour facture</li>
</ul>

<h1>Ajout de produits</h1>
<ul id="categories">
    {% for category in categories %}
        <li style="background:{{category.color}}" id="{{category.id}}"
            href="javascript:void(0)" onclick="javascript:view_category(this.id);">
        {{category.nom}}
    </li>
    {% empty %}
        <li>Aucune categorie disponible.</li>
    {% endfor %}
</ul>

<h2><!-- nombre --></h2>
<ul id="numbers">
    {% for number in range %}
    <li onclick="window.location='{% url "bill_set_number" bill.id number %}'"
        {% if count == number %}class="enabled"{% endif %}>
        {{number}}
    </li>
    {% endfor %}
</ul>

<h2><!--Sélection du produit--></h2>
<ul id="products">
    {% for category in categories %}
        <div id="cat_{{category.id}}" 
            {% if current_cat != category.id %}style="display: none"{% endif %}>
        {% for product in category.products %}
            <li
                onclick="window.location='/bill/{{bill.id}}/product/add/{{product.id}}/'"
                style="background:{{category.color}}">{{product.nom}}
            </li>
        {% endfor %}
        </div>
    {% endfor %}
</ul>

<h1>Produits présents sur la commande</h1>
<p>Vous pouvez supprimer un produit en le sélectionnant.</p>
<ul id="products_sold">
  {% for type_produit, list_produit in bill.regroup_produits.items %}
  {% if list_produit|length > 1 %}
  <li style="background:{{list_produit.0.1.produit.categorie.color}}" id="{{type_produit}}" href="javascript:void(0)" onclick="javascript:myLinkButtonClick(this.id);">{{list_produit|length}} x {{type_produit}}</li>
  <div id="list_{{type_produit}}" style="display: none">
    {% for vendu_id_in_model, vendu in list_produit %}
    <li 
        style="background:{{vendu.produit.categorie.color}}"
        onclick="window.location='{% url "sold_delete" bill.id vendu_id_in_model %}'">
      {{vendu}}
      {% if vendu.cuisson %}({{vendu.cuisson}}){% endif %}
      {{ vendu.get_menu_resume }}
    </li>
    {% endfor %}
  </div>
  {% else %}
  <li 
    style="background:{{list_produit.0.1.produit.categorie.color}}"
    id="{{type_produit}}" 
    onclick="window.location='{% url "sold_delete" bill.id list_produit.0.0 %}'">
    {{list_produit.0.1}}
    {% if list_produit.0.1.cuisson %}({{list_produit.0.1.cuisson}}){% endif %}
    {{ list_produit.0.1.get_menu_resume }}
  </li> 
  {% endif %}
  {% empty %}
  <li>Aucun produit</li>
  {% endfor %}
</ul>

{% endblock %}

